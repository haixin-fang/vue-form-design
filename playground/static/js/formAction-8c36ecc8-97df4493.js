import{Y as j,d as M,i as T,r as _,$ as q,x as I,o as O,z as E,a as c,b as f,n as b,k as N,j as a,l as g,q as v,f as h,w as l,B as C,h as i,F as W,e as J,A as V,Z as L,E as R,a0 as U,M as H,v as K,a1 as Y,I as Z,J as G,K as P}from"./main-7e53c33c.js";/* empty css                */import{c as Q}from"./vue-codemirror.esm-20411d75.js";const X=M({ControlType:"FormAction",isHide:!0,components:{Codemirror:Q},props:{item:{type:Object,default:()=>({})},data:{type:Object,default:()=>({})},drag:{type:Boolean,default:!1},labelalign:{type:String,default:"top"},labelWidth:{type:Number},size:{type:String},isForm:{type:Boolean,default:!1}},setup(e){const{actionContrl:t}=T("control")||{},p=_(),{proxy:F}=q(),s=_(window.VApp.$Flex.deepClone(t?.get("action"))),u=_(window.VApp.$Flex.deepClone(t?.get("currentAction")));let A="";const m=I({funcName:[{required:!0,message:"函数名称必填",trigger:"change"}]});return console.log(e),O(()=>{}),{rules:m,actionRef:p,action:s,currentAction:u,getField(n){return window.VApp.$Flex.getField(n)},onAction(n){if(s.value=window.VApp.$Flex.deepClone(t?.get("action")),p.value.init("动作设置","icon-icon-bianji"),p.value.show(),n){A=n;const o=s.value.find(r=>{if(r.type==n)return r});o?u.value=o:F.addAction(n)}},onEditAction(n,o){A=n,s.value=window.VApp.$Flex.deepClone(t?.get("action")),p.value.init("动作设置","icon-icon-bianji"),p.value.show();const r=s.value.find(y=>{if(y.type==o)return y});r&&(u.value=r)},handleAction(n){u.value=n},onSave(){t?.set("action",s.value),p.value.close()},onCancel(){p.value.close()},copyAction(n){const o=window.VApp.$Flex.deepClone(n);o.funcName=o.funcName+"_copy",o.type=window.VApp.$Flex.generateMixed(5),s.value.push(o),u.value=o},deleteAction(n){s.value=s.value.filter(o=>{if(o.type!==n.type)return o}),u.value&&n.type==u.value.type&&(u.value=null)},addAction(n){const o={funcName:(n||"func")+"_"+window.VApp.$Flex.generateMixed(5),type:window.VApp.$Flex.generateMixed(5),funcStr:"",methods:n};s.value.push(o),n&&(u.value=o)},onConfirm(){e.data[e.item.data.fieldName]||(e.data[e.item.data.fieldName]={}),e.data[e.item.data.fieldName][A]=JSON.stringify(u.value),F.onSave()}}}}),x={key:0,class:"item_require"},ee={class:"common-layout"},te={class:"action-header"},ne={class:"action-list"},oe=["onClick"],le={class:"event-script-menu-label"},ie={key:0,class:"event-script-menu-action"},ae=["onClick"],se=["onClick"],ue={class:"action-header event-script-main-header"},re={class:"coding"},de={class:"header"};function ce(e,t,p,F,s,u){const A=L,m=R,n=U,o=H,r=K,y=Y,B=Z,k=G,$=E("codemirror"),S=P,z=E("CustomDialog");return c(),f("div",{class:b(["starfish-formitem",{formCover:e.drag,"starfish-vertical":e.labelalign!="top",[e.item.data.csslist?.join(" ")]:!!e.item.data.csslist}])},[e.isForm?v("",!0):(c(),f("div",{key:0,class:b(["label","label_"+e.labelalign]),style:N({width:e.labelWidth+"px"})},[a("label",null,g(e.item.data.label),1),e.item.data.required?(c(),f("span",x,"*")):v("",!0),e.item.data.tip?(c(),h(A,{key:1,class:"item",effect:"dark",content:e.item.data.tip,placement:"top"},{default:l(()=>[...t[2]||(t[2]=[a("span",{class:"tip iconfontui icon-tishi"},null,-1)])]),_:1},8,["content"])):v("",!0)],6)),a("div",{class:"control",style:N({marginLeft:e.labelalign!="top"?e.labelWidth+"px":""})},[e.isForm?v("",!0):(c(),h(m,{key:0,style:{width:"100%"},onClick:e.onAction},{default:l(()=>[...t[3]||(t[3]=[C(" 设置 ",-1)])]),_:1},8,["onClick"])),i(z,{ref:"actionRef"},{default:l(()=>[a("div",ee,[i(r,{style:{height:"100%",border:"1px solid rgb(238, 238, 238)"}},{default:l(()=>[i(r,null,{default:l(()=>[i(y,{width:"300px",class:"event-script-aside"},{default:l(()=>[i(r,{class:"is-vertical"},{default:l(()=>[a("header",te,[i(m,{type:"text",size:e.size,onClick:e.addAction},{default:l(()=>[...t[4]||(t[4]=[C(" +添加动作",-1)])]),_:1},8,["size","onClick"])]),i(o,null,{default:l(()=>[i(n,null,{default:l(()=>[a("div",ne,[(c(!0),f(W,null,J(e.action,(d,D)=>(c(),f("div",{class:b(["action",e.currentAction&&d.type==e.currentAction.type?"selectAction":""]),key:D,onClick:w=>e.handleAction(d)},[t[5]||(t[5]=a("span",{class:"event-script-menu-i"},"Function",-1)),a("div",le,g(d.funcName),1),d.disabled?v("",!0):(c(),f("div",ie,[a("i",{title:"复制",class:"iconfontui icon-fuzhi",onClick:V(w=>e.copyAction(d),["stop"])},null,8,ae),a("i",{title:"删除",class:"iconfontui icon-shanchu1",onClick:V(w=>e.deleteAction(d),["stop"])},null,8,se)]))],10,oe))),128))])]),_:1})]),_:1})]),_:1})]),_:1}),i(o,{class:"event-script-main"},{default:l(()=>[i(r,{class:"is-vertical"},{default:l(()=>[a("header",ue,[i(m,{type:"primary",onClick:e.onConfirm,size:"small"},{default:l(()=>[...t[6]||(t[6]=[C("确定",-1)])]),_:1},8,["onClick"]),i(m,{type:"primary",onClick:e.onSave,size:"small"},{default:l(()=>[...t[7]||(t[7]=[C("保存",-1)])]),_:1},8,["onClick"]),i(m,{onClick:e.onCancel,size:"small"},{default:l(()=>[...t[8]||(t[8]=[C("取消",-1)])]),_:1},8,["onClick"])]),e.currentAction?(c(),h(o,{key:0,class:"func_main"},{default:l(()=>[i(n,null,{default:l(()=>[i(S,{model:e.currentAction,rules:e.rules},{default:l(()=>[i(k,{label:"Function Name",prop:"funcName"},{default:l(()=>[i(B,{modelValue:e.currentAction.funcName,"onUpdate:modelValue":t[0]||(t[0]=d=>e.currentAction.funcName=d),disabled:e.currentAction.disabled},null,8,["modelValue","disabled"])]),_:1}),i(k,{prop:"funcStr"},{default:l(()=>[a("div",re,[a("div",de," function "+g(e.currentAction.funcName)+"("+g(e.getField(e.currentAction.methods))+"){ ",1),i($,{modelValue:e.currentAction.funcStr,"onUpdate:modelValue":t[1]||(t[1]=d=>e.currentAction.funcStr=d),placeholder:"",style:{height:"400px"},mode:"text/javascript",autofocus:!0,"indent-with-tab":!0,"tab-size":2},null,8,["modelValue"]),t[9]||(t[9]=a("div",{class:"footer"},"}",-1))])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):v("",!0)]),_:1})]),_:1})]),_:1})]),_:1})])]),_:1},512)],4)],2)}const ve=j(X,[["render",ce]]);export{ve as default};
