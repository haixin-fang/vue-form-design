import{_ as A,d as M,r as D,x as J,y as O,t as B,z as S,a as f,f as p,h as n,w as r,j,b as E,F as _,e as w,q as b,A as I,B as y,s as z,C as q,G,H,I as K,J as P,K as Q,L as W,E as X,M as Y,N as Z,v as x}from"./main-7e53c33c.js";/* empty css                */import{E as ee,a as le}from"./el-table-column-092dd68f.js";const ae=M({props:{data:{type:Object,default(){return{}}},item:{type:Object,default(){return{}}}},emits:["change"],setup(i,{emit:s}){const c=D(),F=D(),v=D();function V(){var l,e;const o=(l=q)==null?void 0:l.get("allFormList"),d=[];(e=B(o))==null||e.forEach(C=>{window.VueContext.$Flex.getFormDataList(C,d,i.data.fieldName)}),v.value=d}const t=J({andData:[[]],logicList:[{value:"=",label:"等于"},{value:"!=",label:"不等于"}],typeList:[{value:"常量",label:"常量"}]});return{...O(t),fieldList:v,maxJsonDialog:c,formList:F,handleType(l,e,o){o=="布尔"&&(t.andData[e][l].value=!0)},getLogic(l,e){const o=v.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d});return o&&o.options&&o.multiple?[{value:"in",label:"包含"},{value:"not in",label:"不包含"}]:o&&o.switch?[{value:"=",label:"等于"}]:t.logicList},getFiled(l,e){return!t.andData[e][l]||!t.andData[e][l].field?[]:v.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d}).options||[]},show(){c.value.init("可用条件","icon-icon-bianji"),c.value.show(),console.log(i.data),typeof i.data.showRule!="string"&&Array.isArray(i.data.showRule)?t.andData=i.data.showRule:t.andData=[[]],V()},getMultiple(l,e){return!!v.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d}).multiple},getNewTypeList(l,e){const o=v.value.find(d=>{if(t.andData[e][l]&&d.value==t.andData[e][l].field)return d});return o&&o.options?[{rule:[],value:"选项",label:"选项"}]:o&&o.switch?[{value:"布尔",label:"布尔"}]:t.typeList},deleteRow(l,e){t.andData[e].splice(l,1)},getTypeIsChange(l,e){return!!t.andData[e][l].type},getRules(l){var e;return{value:(e=t.typeList.find(o=>o.value==l))==null?void 0:e.rule}},async onAddItem(l){t.andData[l].push({field:"",logic:"",type:"",value:""})},onOrItem(){t.andData.push([])},closeDialog(){c.value.close()},saveJson(){const l=B(t.andData).filter(e=>{if(e.length>0)return e}).map(e=>{const o=e.filter(d=>{if(d.field)return d});if(o.length>0)return o}).filter(e=>!!e);s("change",l),c.value.close()}}}});function te(i,s,c,F,v,V){const t=G,l=H,e=ee,o=K,d=P,C=Q,k=W,g=X,L=le,h=Y,$=Z,R=x,U=S("CustomDialog");return f(),p(z,{to:"body"},[n(U,{ref:"maxJsonDialog",dialogclass:"conditionSelectNormal"},{default:r(()=>[n(h,{style:{padding:"0"}},{default:r(()=>[n(R,{style:{height:"100%"}},{default:r(()=>[n(h,{class:"my-pageMain"},{default:r(()=>[s[3]||(s[3]=j("div",{class:"tipContent"},"满足以下所有条件时,此组件可用",-1)),(f(!0),E(_,null,w(i.andData,(T,m)=>(f(),E("div",{class:"tableContainer",key:m},[n(L,{data:T,style:{width:"100%"},border:""},{default:r(()=>[n(e,{prop:"field",label:"字段"},{default:r(a=>[n(l,{modelValue:a.row.field,"onUpdate:modelValue":u=>a.row.field=u,placeholder:"请选择"},{default:r(()=>[(f(!0),E(_,null,w(i.fieldList,u=>(f(),p(t,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onUpdate:modelValue"])]),_:1}),n(e,{prop:"logic",label:"逻辑"},{default:r(a=>[n(l,{modelValue:a.row.logic,"onUpdate:modelValue":u=>a.row.logic=u,placeholder:"请选择"},{default:r(()=>[(f(!0),E(_,null,w(i.getLogic(a.$index,m),u=>(f(),p(t,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1024),n(e,{prop:"type",label:"值类型"},{default:r(a=>[n(l,{modelValue:a.row.type,"onUpdate:modelValue":u=>a.row.type=u,placeholder:"请选择",onChange:u=>i.handleType(a.$index,m,a.row.type)},{default:r(()=>[(f(!0),E(_,null,w(i.getNewTypeList(a.$index,m),u=>(f(),p(t,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","onChange"])]),_:2},1024),n(e,{prop:"value",label:"值"},{default:r(a=>[i.getTypeIsChange(a.$index,m)&&a.row.type=="常量"?(f(),p(C,{key:0,model:a.row,rules:i.getRules(a.row.type),ref_for:!0,ref:"formList"},{default:r(()=>[n(d,{prop:"value"},{default:r(()=>[n(o,{text:"",modelValue:a.row.value,"onUpdate:modelValue":u=>a.row.value=u},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024)]),_:2},1032,["model","rules"])):b("",!0),a.row.type=="选项"?(f(),p(l,{key:1,modelValue:a.row.value,"onUpdate:modelValue":u=>a.row.value=u,filterable:"",placeholder:"请选择",multiple:i.getMultiple(a.$index,m)},{default:r(()=>[n(t,{label:"未选择",value:""}),(f(!0),E(_,null,w(i.getFiled(a.$index,m),(u,N)=>(f(),p(t,{key:N,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:2},1032,["modelValue","onUpdate:modelValue","multiple"])):b("",!0),a.row.type=="布尔"?(f(),p(k,{key:2,modelValue:a.row.value,"onUpdate:modelValue":u=>a.row.value=u},null,8,["modelValue","onUpdate:modelValue"])):b("",!0)]),_:2},1024),n(e,{fixed:"right",label:"操作",width:"100"},{default:r(a=>[n(g,{size:"small",type:"danger",onClick:I(u=>i.deleteRow(a.$index,m),["prevent"])},{default:r(()=>[...s[0]||(s[0]=[y(" 删除 ",-1)])]),_:1},8,["onClick"])]),_:2},1024)]),_:2},1032,["data"]),n(g,{class:"mt-4",style:{width:"100%"},text:"",onClick:a=>i.onAddItem(m)},{default:r(()=>[...s[1]||(s[1]=[y("+并条件",-1)])]),_:1},8,["onClick"])]))),128)),n(g,{class:"mt-4",text:"",onClick:i.onOrItem},{default:r(()=>[...s[2]||(s[2]=[y("+或条件",-1)])]),_:1},8,["onClick"])]),_:1}),n($,{class:"my-Footer",style:{height:"60px","padding-top":"10px","text-align":"right"}},{default:r(()=>[n(g,{type:"primary",onClick:i.saveJson},{default:r(()=>[...s[4]||(s[4]=[y("保存",-1)])]),_:1},8,["onClick"]),n(g,{onClick:i.closeDialog},{default:r(()=>[...s[5]||(s[5]=[y("关闭",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1})]),_:1},512)])}var re=A(ae,[["render",te]]);export{re as default};
